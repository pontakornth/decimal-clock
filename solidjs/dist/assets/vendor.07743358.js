const ne=(e,t)=>e===t,O={equals:ne};let J=Z;const E={},C=1,k=2,X={owned:null,cleanups:null,context:null,owner:null};var a=null;let N=null,c=null,v=null,g=null,S=null,F=0;function D(e,t){t&&(a=t);const s=c,n=a,l=e.length===0?X:{owned:null,cleanups:null,context:null,owner:n};a=l,c=null;let o;try{K(()=>o=e(()=>V(l)),!0)}finally{c=s,a=n}return o}function le(e,t){t=t?Object.assign({},O,t):O;const s={value:e,observers:null,observerSlots:null,pending:E,comparator:t.equals||void 0};return[Y.bind(s),n=>(typeof n=="function"&&(n=n(s.pending!==E?s.pending:s.value)),q(s,n))]}function R(e,t,s){P(H(e,t,!1,C))}function ie(e,t,s){J=ce;const n=H(e,t,!1,C);n.user=!0,S&&S.push(n)}function G(e,t,s){s=s?Object.assign({},O,s):O;const n=H(e,t,!0,0);return n.pending=E,n.observers=null,n.observerSlots=null,n.comparator=s.equals||void 0,P(n),Y.bind(n)}function fe(e){if(v)return e();let t;const s=v=[];try{t=e()}finally{v=null}return K(()=>{for(let n=0;n<s.length;n+=1){const l=s[n];if(l.pending!==E){const o=l.pending;l.pending=E,q(l,o)}}},!1),t}function B(e){let t,s=c;return c=null,t=e(),c=s,t}function pe(e){ie(()=>B(e))}function oe(e){return a===null||(a.cleanups===null?a.cleanups=[e]:a.cleanups.push(e)),e}function Y(){if(this.state&&this.sources){const e=g;g=null,this.state===C||N?P(this):Q(this),g=e}if(c){const e=this.observers?this.observers.length:0;c.sources?(c.sources.push(this),c.sourceSlots.push(e)):(c.sources=[this],c.sourceSlots=[e]),this.observers?(this.observers.push(c),this.observerSlots.push(c.sources.length-1)):(this.observers=[c],this.observerSlots=[c.sources.length-1])}return this.value}function q(e,t,s){if(e.comparator&&e.comparator(e.value,t))return t;if(v)return e.pending===E&&v.push(e),e.pending=t,t;let n=!1;return e.value=t,e.observers&&e.observers.length&&K(()=>{for(let l=0;l<e.observers.length;l+=1){const o=e.observers[l];n&&N.disposed.has(o),o.pure?g.push(o):S.push(o),o.observers&&(n&&!o.tState||!n&&!o.state)&&_(o),n||(o.state=C)}if(g.length>1e6)throw g=[],new Error},!1),t}function P(e){if(!e.fn)return;V(e);const t=a,s=c,n=F;c=a=e,re(e,e.value,n),c=s,a=t}function re(e,t,s){let n;try{n=e.fn(t)}catch(l){$(l)}(!e.updatedAt||e.updatedAt<=s)&&(e.observers&&e.observers.length?q(e,n):e.value=n,e.updatedAt=s)}function H(e,t,s,n=C,l){const o={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:a,context:null,pure:s};return a===null||a!==X&&(a.owned?a.owned.push(o):a.owned=[o]),o}function L(e){const t=N;if(e.state!==C)return e.state=0;if(e.suspense&&B(e.suspense.inFallback))return e.suspense.effects.push(e);const s=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<F);)(e.state||t)&&s.push(e);for(let n=s.length-1;n>=0;n--)if(e=s[n],e.state===C||t)P(e);else if(e.state===k||t){const l=g;g=null,Q(e),g=l}}function K(e,t){if(g)return e();let s=!1;t||(g=[]),S?s=!0:S=[],F++;try{e()}catch(n){$(n)}finally{ue(s)}}function ue(e){g&&(Z(g),g=null),!e&&(S.length?fe(()=>{J(S),S=null}):S=null)}function Z(e){for(let t=0;t<e.length;t++)L(e[t])}function ce(e){let t,s=0;for(t=0;t<e.length;t++){const l=e[t];l.user?e[s++]=l:L(l)}const n=e.length;for(t=0;t<s;t++)L(e[t]);for(t=n;t<e.length;t++)L(e[t])}function Q(e){e.state=0;for(let t=0;t<e.sources.length;t+=1){const s=e.sources[t];s.sources&&(s.state===C||N?L(s):s.state===k&&Q(s))}}function _(e){const t=N;for(let s=0;s<e.observers.length;s+=1){const n=e.observers[s];(!n.state||t)&&(n.state=k,n.pure?g.push(n):S.push(n),n.observers&&_(n))}}function V(e){let t;if(e.sources)for(;e.sources.length;){const s=e.sources.pop(),n=e.sourceSlots.pop(),l=s.observers;if(l&&l.length){const o=l.pop(),f=s.observerSlots.pop();n<l.length&&(o.sourceSlots[f]=n,l[n]=o,s.observerSlots[n]=f)}}if(e.owned){for(t=0;t<e.owned.length;t++)V(e.owned[t]);e.owned=null}if(e.cleanups){for(t=0;t<e.cleanups.length;t++)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function $(e){throw e}const he=Symbol("fallback");function z(e){for(let t=0;t<e.length;t++)e[t]()}function ae(e,t,s={}){let n=[],l=[],o=[],f=0,i=t.length>1?[]:null;return oe(()=>z(o)),()=>{let p=e()||[],u,r;return B(()=>{let h=p.length,w,m,T,M,U,b,y,A,x;if(h===0)f!==0&&(z(o),o=[],n=[],l=[],f=0,i&&(i=[])),s.fallback&&(n=[he],l[0]=D(se=>(o[0]=se,s.fallback())),f=1);else if(f===0){for(l=new Array(h),r=0;r<h;r++)n[r]=p[r],l[r]=D(d);f=h}else{for(T=new Array(h),M=new Array(h),i&&(U=new Array(h)),b=0,y=Math.min(f,h);b<y&&n[b]===p[b];b++);for(y=f-1,A=h-1;y>=b&&A>=b&&n[y]===p[A];y--,A--)T[A]=l[y],M[A]=o[y],i&&(U[A]=i[y]);for(w=new Map,m=new Array(A+1),r=A;r>=b;r--)x=p[r],u=w.get(x),m[r]=u===void 0?-1:u,w.set(x,r);for(u=b;u<=y;u++)x=n[u],r=w.get(x),r!==void 0&&r!==-1?(T[r]=l[u],M[r]=o[u],i&&(U[r]=i[u]),r=m[r],w.set(x,r)):o[u]();for(r=b;r<h;r++)r in T?(l[r]=T[r],o[r]=M[r],i&&(i[r]=U[r],i[r](r))):l[r]=D(d);l=l.slice(0,f=h),n=p.slice(0)}return l});function d(h){if(o[r]=h,i){const[w,m]=le(r);return i[r]=m,t(p[r],w)}return t(p[r])}}}function de(e,t){return B(()=>e(t))}function we(e){const t="fallback"in e&&{fallback:()=>e.fallback};return G(ae(()=>e.each,e.children,t||void 0))}function be(e){let t=!1;const s=G(()=>e.when,void 0,{equals:(n,l)=>t?n===l:!n==!l});return G(()=>{const n=s();if(n){const l=e.children;return(t=typeof l=="function"&&l.length>0)?B(()=>l(n)):l}return e.fallback})}function ee(e,t,s){let n=s.length,l=t.length,o=n,f=0,i=0,p=t[l-1].nextSibling,u=null;for(;f<l||i<o;){if(t[f]===s[i]){f++,i++;continue}for(;t[l-1]===s[o-1];)l--,o--;if(l===f){const r=o<n?i?s[i-1].nextSibling:s[o-i]:p;for(;i<o;)e.insertBefore(s[i++],r)}else if(o===i)for(;f<l;)(!u||!u.has(t[f]))&&e.removeChild(t[f]),f++;else if(t[f]===s[o-1]&&s[i]===t[l-1]){const r=t[--l].nextSibling;e.insertBefore(s[i++],t[f++].nextSibling),e.insertBefore(s[--o],r),t[l]=s[o]}else{if(!u){u=new Map;let d=i;for(;d<o;)u.set(s[d],d++)}const r=u.get(t[f]);if(r!=null)if(i<r&&r<o){let d=f,h=1,w;for(;++d<l&&d<o&&!((w=u.get(t[d]))==null||w!==r+h);)h++;if(h>r-i){const m=t[f];for(;i<r;)e.insertBefore(s[i++],m)}else e.replaceChild(s[i++],t[f++])}else f++;else e.removeChild(t[f++])}}}function ye(e,t,s){let n;return D(l=>{n=l,ge(t,e(),t.firstChild?null:void 0,s)}),()=>{n(),t.textContent=""}}function Se(e,t,s){const n=document.createElement("template");n.innerHTML=e;let l=n.content.firstChild;return s&&(l=l.firstChild),l}function ge(e,t,s,n){if(s!==void 0&&!n&&(n=[]),typeof t!="function")return j(e,t,n,s);R(l=>j(e,t(),l,s),n)}function j(e,t,s,n,l){for(;typeof s=="function";)s=s();if(t===s)return s;const o=typeof t,f=n!==void 0;if(e=f&&s[0]&&s[0].parentNode||e,o==="string"||o==="number")if(o==="number"&&(t=t.toString()),f){let i=s[0];i&&i.nodeType===3?i.data=t:i=document.createTextNode(t),s=I(e,s,n,i)}else s!==""&&typeof s=="string"?s=e.firstChild.data=t:s=e.textContent=t;else if(t==null||o==="boolean")s=I(e,s,n);else{if(o==="function")return R(()=>{let i=t();for(;typeof i=="function";)i=i();s=j(e,i,s,n)}),()=>s;if(Array.isArray(t)){const i=[];if(W(i,t,l))return R(()=>s=j(e,i,s,n,!0)),()=>s;if(i.length===0){if(s=I(e,s,n),f)return s}else Array.isArray(s)?s.length===0?te(e,i,n):ee(e,s,i):s==null||s===""?te(e,i):ee(e,f&&s||[e.firstChild],i);s=i}else if(t instanceof Node){if(Array.isArray(s)){if(f)return s=I(e,s,n,t);I(e,s,null,t)}else s==null||s===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);s=t}}return s}function W(e,t,s){let n=!1;for(let l=0,o=t.length;l<o;l++){let f=t[l],i;if(f instanceof Node)e.push(f);else if(!(f==null||f===!0||f===!1))if(Array.isArray(f))n=W(e,f)||n;else if((i=typeof f)==="string")e.push(document.createTextNode(f));else if(i==="function")if(s){for(;typeof f=="function";)f=f();n=W(e,Array.isArray(f)?f:[f])||n}else e.push(f),n=!0;else e.push(document.createTextNode(f.toString()))}return n}function te(e,t,s){for(let n=0,l=t.length;n<l;n++)e.insertBefore(t[n],s)}function I(e,t,s,n){if(s===void 0)return e.textContent="";const l=n||document.createTextNode("");if(t.length){let o=!1;for(let f=t.length-1;f>=0;f--){const i=t[f];if(l!==i){const p=i.parentNode===e;!o&&!f?p?e.replaceChild(l,i):e.insertBefore(l,s):p&&e.removeChild(i)}else o=!0}}else e.insertBefore(l,s);return[l]}export{we as F,be as S,de as a,R as b,le as c,oe as d,ge as i,pe as o,ye as r,Se as t};
